# STM32CubeMX C++ Converter

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Version: v0.1.0](https://img.shields.io/badge/version-v0.1.0-blue.svg)](https://github.com/lc6464/STM32CubeMX-CPPConvertor/releases/tag/v0.1.0)
[![Platforms](https://img.shields.io/badge/platform-win%20%7C%20linux%20%7C%20macos-green.svg)](https://github.com/lc6464/STM32CubeMX-CPPConvertor)

ä¸€ä¸ªç®€å•ã€é«˜æ•ˆçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ—¨åœ¨**å…¨è‡ªåŠ¨**åœ°å°†ç”± **STM32CubeMX** ç”Ÿæˆçš„åŸºäº **CMake** çš„ **C** è¯­è¨€é¡¹ç›®ï¼Œæ— ç¼è½¬æ¢ä¸º **C++** å…¼å®¹é¡¹ç›®ã€‚

## è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ

STM32CubeMX æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å›¾å½¢åŒ–é…ç½®å·¥å…·ï¼Œä½†å®ƒç”Ÿæˆçš„ CMake é¡¹ç›®é»˜è®¤æ˜¯çº¯ C è¯­è¨€ç¯å¢ƒã€‚å½“å¼€å‘è€…å¸Œæœ›åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ C++ çš„ç‰¹æ€§æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹ç”± CubeMX ç®¡ç†çš„ `cmake/stm32cubemx/CMakeLists.txt` æ–‡ä»¶ã€‚

æ›´ç³Ÿç³•çš„æ˜¯ï¼Œ**æ¯å½“æ‚¨åœ¨ CubeMX ä¸­é‡æ–°ç”Ÿæˆä»£ç æ—¶ï¼Œè¿™äº›æ‰‹åŠ¨ä¿®æ”¹éƒ½ä¼šè¢«è¦†ç›–**ã€‚

æœ¬å·¥å…·é€šè¿‡ä¸ CubeMX çš„**ç”¨æˆ·æ“ä½œ (User Actions)** åŠŸèƒ½æ·±åº¦é›†æˆï¼Œå®ç°äº†â€œä¸€æ¬¡é…ç½®ï¼Œæ°¸ä¹…æœ‰æ•ˆâ€çš„è‡ªåŠ¨åŒ–è½¬æ¢ã€‚

## å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

å½“è¢« CubeMX è‡ªåŠ¨è°ƒç”¨æ—¶ï¼Œæœ¬å·¥å…·ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
1. **æ‰«æé¡¹ç›®**ï¼šéªŒè¯å½“å‰ç›®å½•æ˜¯å¦ä¸ºä¸€ä¸ªæœ‰æ•ˆçš„ã€ç”± CubeMX ç”Ÿæˆçš„ CMake é¡¹ç›®ã€‚
2. **è§£ææ–‡ä»¶**ï¼šè¯»å– `cmake/stm32cubemx/CMakeLists.txt` æ–‡ä»¶ã€‚
3. **æ™ºèƒ½åŒ¹é…**ï¼šå¯¹äºæ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œ `.c` æºæ–‡ä»¶å¼•ç”¨ï¼ˆå¦‚ `Core/Src/main.c`ï¼‰ï¼Œå®ƒä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨å¯¹åº”çš„ `.cpp` æ–‡ä»¶ï¼ˆå¦‚ `Core/Src/main.cpp`ï¼‰ã€‚
4. **å®‰å…¨æ›´æ–°**ï¼šå¦‚æœæ‰¾åˆ°åŒ¹é…çš„ `.cpp` æ–‡ä»¶ï¼Œå®ƒä¼šï¼š
    - å°†åŸå§‹çš„ `.c` æ–‡ä»¶é‡å‘½åä¸º `.c.bak` ä½œä¸ºå¤‡ä»½ã€‚
    - åœ¨ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ç”Ÿæˆæ–°çš„ `CMakeLists.txt` å†…å®¹ï¼Œå°† `.c` è·¯å¾„æ›¿æ¢ä¸º `.cpp` è·¯å¾„ã€‚
    - ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶çš„å†…å®¹å®‰å…¨åœ°è¦†ç›–åŸå§‹çš„ `CMakeLists.txt` æ–‡ä»¶ã€‚
5. **å®Œæˆ**ï¼æ‚¨çš„é¡¹ç›®ç°åœ¨å·²ç»æ— ç¼åœ°é“¾æ¥äº† C++ æºæ–‡ä»¶ï¼Œæ— éœ€ä»»ä½•æ‰‹åŠ¨å¹²é¢„ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **å…¨è‡ªåŠ¨è½¬æ¢**ï¼šé€šè¿‡ CubeMX çš„ **User Actions** é›†æˆï¼Œåœ¨æ¯æ¬¡ç”Ÿæˆä»£ç åè‡ªåŠ¨è¿è¡Œã€‚
- **é¡¹ç›®éªŒè¯**ï¼šåœ¨æ‰§è¡Œæ“ä½œå‰ï¼Œä¼šæ£€æŸ¥é¡¹ç›®åç§°ã€å·¥å…·é“¾è®¾ç½® (CMake) å’Œ CubeMX ç‰ˆæœ¬ã€‚
- **å®‰å…¨å¤‡ä»½**ï¼šè‡ªåŠ¨å°†åŸå§‹çš„ `.c` æ–‡ä»¶å¤‡ä»½ä¸º `.c.bak`ã€‚
- **å¼ºå¤§çš„æ–‡ä»¶æ“ä½œ**ï¼šé€šè¿‡â€œå†™å…¥-å¤åˆ¶â€æ¨¡å¼ï¼Œå³ä½¿ç›®æ ‡æ–‡ä»¶è¢«å…¶ä»–è¿›ç¨‹é”å®šï¼Œä¹Ÿèƒ½æˆåŠŸæ›´æ–°ã€‚
- **è·¨å¹³å°**ï¼š
  - ä¸º Windows x64 æä¾›ç¼–è¯‘ç‰ˆæœ¬ã€‚
  - æ”¯æŒåœ¨ Windows/Linux/macOS (x64 & arm64) ä¸Šè‡ªè¡Œç¼–è¯‘è¿è¡Œã€‚

## ğŸš€ ä½¿ç”¨æŒ‡å—

### æ¨èæ–¹æ³•: ä¸ STM32CubeMX é›†æˆ (ä¸€æ¬¡é…ç½®ï¼Œæ°¸ä¹…æœ‰æ•ˆ)

1. **å‡†å¤‡é¡¹ç›®**: åœ¨ STM32CubeMX ä¸­é…ç½®æ‚¨çš„ MCUï¼Œå¹¶åœ¨ **Project Manager** -> **Toolchain/IDE** ä¸­é€‰æ‹© `CMake`ã€‚
2. **é‡å‘½åæ–‡ä»¶**: åœ¨æ‚¨çš„æ–‡ä»¶ç®¡ç†å™¨æˆ– IDE ä¸­ï¼Œæ‰‹åŠ¨å°†æ‚¨å¸Œæœ›ç”¨ C++ ç¼–å†™çš„æºæ–‡ä»¶ä» `.c` é‡å‘½åä¸º `.cpp`ã€‚ä¾‹å¦‚ï¼Œå°† `Core/Src/main.c` é‡å‘½åä¸º `Core/Src/main.cpp`ã€‚
3. **ä¸‹è½½/ç¼–è¯‘å·¥å…·**:
    - **Windows x64**: ä»æœ¬é¡¹ç›®çš„ [Releases é¡µé¢](https://github.com/lc6464/STM32CubeMX-CPPConvertor/releases)ä¸‹è½½ `STM32CubeMXCPPConvertor.exe`ã€‚
    - **Linux/macOS**: è¯·å‚ç…§ä¸‹æ–‡çš„â€œä»æºç ç¼–è¯‘â€æŒ‡å—ã€‚
4. **æ”¾ç½®å·¥å…·**: å°†å¯æ‰§è¡Œæ–‡ä»¶æ”¾ç½®åœ¨æ‚¨ STM32 é¡¹ç›®çš„ **æ ¹ç›®å½•** (ä¸ `.ioc` æ–‡ä»¶åŒçº§)ã€‚
5. **é…ç½® CubeMX**:
    - åœ¨ STM32CubeMX ä¸­ï¼Œæ‰“å¼€ **Project Manager** -> **Code Generator** æ ‡ç­¾é¡µã€‚
    - æ‰¾åˆ° **User Actions** é¢æ¿ã€‚
    - åœ¨ **After Code Generation** è¾“å…¥æ¡†ä¸­ï¼Œå¡«å…¥å¯æ‰§è¡Œæ–‡ä»¶çš„åç§°ï¼š`STM32CubeMXCPPConvertor.exe` *(å¯¹äº Linux/macOS ç”¨æˆ·ï¼Œåº”ä¸º `STM32CubeMXCPPConvertor`)*
6. **ç”Ÿæˆä»£ç **: ç‚¹å‡» **Generate Code**ã€‚ç°åœ¨ï¼Œæ¯æ¬¡ç”Ÿæˆä»£ç åï¼Œè½¬æ¢å™¨éƒ½ä¼šè‡ªåŠ¨è¿è¡Œï¼Œæ›´æ–°æ‚¨çš„ `CMakeLists.txt`ï¼

### å¤‡ç”¨æ–¹æ³•: æ‰‹åŠ¨æ‰§è¡Œ

å¦‚æœæ‚¨åªæƒ³è¿›è¡Œä¸€æ¬¡æ€§è½¬æ¢ï¼Œå¯ä»¥è·³è¿‡ç¬¬ 5 æ­¥ï¼Œç›´æ¥åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ç»ˆç«¯ä¸­æ‰‹åŠ¨è¿è¡Œè¯¥å·¥å…·ã€‚

``` bash
# åœ¨ Windows ä¸Š
.\STM32CubeMXCPPConvertor.exe

# åœ¨ Linux/macOS ä¸Š
./STM32CubeMXCPPConvertor
```

## ğŸ› ï¸ ä»æºç ç¼–è¯‘

å¯¹äº Linux, macOS, æˆ– arm64 ç”¨æˆ·ï¼Œå¯ä»¥è½»æ¾åœ°ä»æºç ç¼–è¯‘ï¼š
1. å®‰è£… [.NET 9 SDK](https://dotnet.microsoft.com/download/dotnet/9.0)ã€‚
2. å…‹éš†æœ¬ä»“åº“ï¼š`git clone https://github.com/lc6464/STM32CubeMX-CPPConvertor.git`
3. è¿›å…¥é¡¹ç›®ç›®å½•ï¼š`cd STM32CubeMX-CPPConvertor`
4. è¿è¡Œ `publish` å‘½ä»¤ã€‚è¯·å°† `<RID>` æ›¿æ¢ä¸ºæ‚¨çš„ç›®æ ‡å¹³å°æ ‡è¯†ç¬¦ (ä¾‹å¦‚ `linux-x64`, `osx-arm64`)ï¼š
    ```
	dotnet publish -c Release -r <RID> /p:PublishSingleFile=true
	```
    - Windows x64: `win-x64`
    - Linux x64: `linux-x64`
    - macOS x64: `osx-x64`
    - macOS Arm64 (Apple Silicon): `osx-arm64`
5. ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä½äº `bin/Release/net9.0/<RID>/publish/` ç›®å½•ä¸‹ã€‚

## è®¸å¯åè®®

æœ¬é¡¹ç›®åŸºäº [MIT License](LICENSE) æˆæƒã€‚